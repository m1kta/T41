(window["webpackJsonp-ae-fe/cosmos-1"]=window["webpackJsonp-ae-fe/cosmos-1"]||[]).push([[17],{178:function(e,t,o){},490:function(e,t,o){},491:function(e,t,o){},517:function(e,t,o){"use strict";o.r(t);var n=o(18),i=o(11),a=o(8),s=o(96),r=function(){var e,t;return(null===(e=document.querySelector('meta[name="data-spm"]'))||void 0===e?void 0:e.getAttribute("content"))+"."+(null===(t=document.body)||void 0===t?void 0:t.getAttribute("data-spm"))};var c=function(e,t,o){var n,i=e||{},s=i.title,c=i.content,u=i.buttonCancel,d=i.buttonOk;c&&(c=(c=(n=c)&&n.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&nbsp;/g," ")).replaceAll(/<i class="css_flag css_\w+"><\/i>/g,(function(e){var t;return'<div class="saas-pop-flag">'+(null==e||null===(t=e.toLowerCase())||void 0===t?void 0:t.replaceAll("css_flag","_global-css_flag"))+"</div>"})));var p='<div class="saas-pop-dialog '+(window.navigator.userAgent.match(/(phone|pad|pod|iPhone|iPod|iPad|ios|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)?"saas-pop-sm":"")+'">\n      <div class="saas-pop-mask"></div>\n      <div class="saas-pop-content">\n        <h3 class="saas-pop-title">'+s+'</h3>\n        <div class="saas-pop-text">'+c+'</div>\n        <div class="saas-pop-btns">\n          <button class="saas-pop-yes" id="saas-pop-yes">'+d+'</button>\n          <button class="saas-pop-no" id="saas-pop-no">'+u+"</button>\n        </div>\n      </div>\n    </div>";if(document.getElementById("saas-pop"))return Promise.reject();var v=document.createElement("div");return v.setAttribute("id","saas-pop"),v.innerHTML=p,document.body.appendChild(v),new Promise((function(e,n){var i,s,c=function(){l(t,o,"YES").then((function(t){u(),e({status:"SELECT_YES"})})).catch((function(e){n({status:"REQUEST_FAIL"})})),null===a.util||void 0===a.util||a.util.tracker.clk({ae_project_id:"180139",ae_page_type:r(),ae_button_type:"saas-pop-yes"})},u=function(){var e,t=document.getElementById("saas-pop");t&&(null===(e=document.getElementById("saas-pop-yes"))||void 0===e||e.removeEventListener("click",c),document.body.removeChild(t))};null===(i=document.getElementById("saas-pop-yes"))||void 0===i||i.addEventListener("click",c),null===(s=document.getElementById("saas-pop-no"))||void 0===s||s.addEventListener("click",(function(){l(t,o,"NO").then((function(t){u(),e({status:"SELECT_NO"})})).catch((function(e){u(),n({status:"REQUEST_FAIL"})})),null===a.util||void 0===a.util||a.util.tracker.clk({ae_project_id:"180139",ae_page_type:r(),ae_button_type:"saas-pop-no"})})),null===a.util||void 0===a.util||a.util.tracker.exp({exp_page:r(),exp_page_area:"dialog",exp_type:"saas-pop"})}))},l=function(e,t,o){return n.a.request({api:"mtop.ru.aliexpress.shipto.switch",v:"1.0",timeout:6e3,data:{currentCountry:e,toCountry:t,agreed:o,url:"",_lang:i.a.getLocale()||"en_US"}}).then((function(e){var t;return"true"===(null==e||null===(t=e.data)||void 0===t?void 0:t.result)?e:Promise.reject(e)}))},u=function(e,t,o){return e&&t?function(e,t,o){return n.a.request({api:"mtop.ru.aliexpress.shipto.switch",v:"1.0",timeout:6e3,data:{currentCountry:e,toCountry:t,_lang:i.a.getLocale()||"en_US"}}).then((function(n){var a,r,l;return"true"===(null==n||null===(a=n.data)||void 0===a||null===(r=a.model)||void 0===r?void 0:r.popup)?c(null==n||null===(l=n.data)||void 0===l?void 0:l.model,e,t).then((function(e){return"SELECT_YES"===(null==e?void 0:e.status)&&null!=o&&o.saveCookie?(i.a.setRegion(t),Object(s.syncCookieFunc)().then((function(){return null!=o&&o.refreshPage&&window.location.reload(),{status:"SELECT_YES"}})).catch((function(e){return Promise.resolve({status:"SELECT_YES"})}))):e})):Promise.resolve({status:"NO_POP"})})).catch((function(e){Promise.reject({status:"REQUEST_FAIL"})}))}(null==e?void 0:e.toUpperCase(),null==t?void 0:t.toUpperCase(),o).then((function(e){return!(!e||"SELECT_YES"!=(null==e?void 0:e.status)&&"NO_POP"!=(null==e?void 0:e.status))})):Promise.reject()},d=(o(490),o(178),u),p=i.a.getRegion(),v=function(e){return e&&"CN"!=e?'<span class="_global-css_flag css_'+e.toLowerCase()+'"></span>':""},m=function(){var e,t;return(null===(e=document.querySelector('meta[name="data-spm"]'))||void 0===e?void 0:e.getAttribute("content"))+"."+(null===(t=document.body)||void 0===t?void 0:t.getAttribute("data-spm"))},g=function(){var e,t=localStorage.getItem("check_address_tip");try{var o;if(e=JSON.parse(t))e.isTimeOut=(null===(o=e)||void 0===o?void 0:o.time)+864e5<(new Date).getTime()}catch(e){localStorage.removeItem("check_address_tip"),a.util.tracker.sendCustomError(e)}return e||{}},_=function(e){var t=g().countries,o=void 0===t?[]:t;-1==o.indexOf(e)&&o.push(e),localStorage.setItem("check_address_tip",JSON.stringify({countries:o,time:(new Date).getTime()}))},f=function(e){var t,o,n,r,c,l;if(e&&e.data&&!document.getElementById("setting-window-dialog")){var u=e.data,g=u.alertTitle,f=u.alertContentText,h=u.alertAcceptText,y=u.alertDenyText,C=u.addressCountryFullName,w=u.shipToCountryFullName;f=null===(t=f)||void 0===t?void 0:t.replace("{0}",v(e.data.shipToCountry)+"<b>"+e.data.shipToCountryFullName+"</b>").replace("{1}",v(e.data.addressCountry)+"<b>"+e.data.addressCountryFullName+"</b>").replace("{2}",C),h=null===(o=h)||void 0===o?void 0:o.replace("{2}",C),y=null===(n=y)||void 0===n?void 0:n.replace("{1}",w);var k,E='\n            <div class="_shipto-window-dialog '+(((void 0===(k=window.navigator.userAgent)?"":k).match(/(phone|pad|pod|iPhone|iPod|iPad|ios|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i)?"_shipto-pop-sm":"")+'">\n                <div class="_shipto-pop-mask"></div>\n                <div class="_shipto-wrap">\n                    <p class="_shipto-title">')+g+'</p>\n                    <p class="_shipto-content">'+f+'</p>\n                    <div class="_shipto-btn-wrap">\n                        <a class="_shipto-yes" href="javascript:;" id="__shipto-yes">'+h+'</a>\n                        <a class="_shipto-no" href="javascript:;" id="__shipto-no">'+y+"</a>\n                    </div>\n                </div>\n            </div>",b=document.createElement("div");b.setAttribute("id","setting-window-dialog"),b.innerHTML=E,document.body.appendChild(b);var x=i.a.getRegion(),S=null==e||null===(r=e.data)||void 0===r?void 0:r.addressCountry,P=function(){var e,t,o=document.getElementById("setting-window-dialog");o&&(null===(e=document.getElementById("__shipto-yes"))||void 0===e||e.removeEventListener("click",L),null===(t=document.getElementById("__shipto-no"))||void 0===t||t.removeEventListener("click",T),document.body.removeChild(o))},L=function(){P(),d(x,S).then((function(e){e&&(i.a.setProvince(""),i.a.setCity(""),i.a.setRegion(S),_(S),Object(s.syncCookieFunc)().then((function(){window.location.reload()})).catch((function(e){window.location.reload(),a.util.tracker.sendCustomError(e)})))})),null===a.util||void 0===a.util||a.util.tracker.clk({ae_project_id:"180139",ae_page_type:m(),ae_button_type:"setting-pop-yes"})},T=function(){P(),_(p),null===a.util||void 0===a.util||a.util.tracker.clk({ae_project_id:"180139",ae_page_type:m(),ae_button_type:"setting-pop-no"})};null===(c=document.getElementById("__shipto-yes"))||void 0===c||c.addEventListener("click",L),null===(l=document.getElementById("__shipto-no"))||void 0===l||l.addEventListener("click",T),null===a.util||void 0===a.util||a.util.tracker.exp({exp_page:m(),exp_page_area:"dialog",exp_type:"setting-pop"})}},h=function(){if(i.a.isLoggedIn()&&"CN"!=p){var e=g(),t=e.countries,o=e.isTimeOut;-1!==(null==t?void 0:t.indexOf(p))&&!1===o||n.a.request({api:"mtop.aliexpress.address.checkaddress",v:"1.0",data:{_lang:i.a.getLocale()||"en_US",shipToCountryCode:p},ecode:0,type:"GET",appKey:"24815441",dataType:"jsonp",timeout:5e3}).then((function(e){if(e.data)return!0===e.data.match?_(p):f(e)}),(function(e){a.util.tracker.sendCustomError(e)}))}};o(491);h()},96:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syncCookieFunc=t.init=void 0;var n=o(8),i=function(){if(window.headerConfig&&window.headerConfig.disableSyncCookie)return Promise.resolve([!0,!0]);/(iPhone|Android)/.test(navigator.userAgent);var e={fromApp:!1,currency:n.cookie.getCurrency(),region:n.cookie.getRegion(),bLocale:n.cookie.getLocale(),site:n.cookie.getSite(),province:n.cookie.getProvince(),city:n.cookie.getCity()},t=window.location.host,o=!1,i=[{regex:/(.*\.)?aliexpress\.com/,requestUrl:"//login.aliexpress.com/setCommonCookie.htm"},{regex:/(.*\.)?aliexpress\.ru/,requestUrl:"//login.aliexpress.ru/setCommonCookie.htm"},{regex:/(.*\.)?tmall\.ru/,requestUrl:"//login.tmall.ru/setCommonCookie.htm"}].slice(0);i.forEach((function(e,n){e.regex.test(t)&&(o=!0,i.splice(n,1))}));var a=[];return o&&i.forEach((function(t){var o,i,s;a.push((o=t.requestUrl,i=e,(s=function(){return new Promise((function(e){(0,n.request)({url:o,data:i,timeout:5e3,withCredentials:!0}).then((function(t){"success"===t.message?e(!0):e(!1)})).catch((function(){e(!1)}))}))})().then((function(e){return e||s()})).then((function(e){return e||console.error("sync cookie twice fail: "+o+" "+JSON.stringify(i)),e})).catch((function(e){return console.error(e),!1}))))})),Promise.all(a).then((function(e){return e&&2===e.length&&!0===e[0]&&!0===e[1]&&n.cookie.set("0","xman_us_f","x_c_chg"),e}))};t.init=function(){var e=n.cookie.get("xman_us_f","x_c_chg");"1"===n.cookie.get("xman_us_f","x_c_synced")?(n.cookie.set("0","xman_us_f","x_c_chg"),n.cookie.set("0","xman_us_f","x_c_synced")):"1"===e&&i().then((function(e){console.log("get finally result:",e)})).catch((function(e){console.error("catch error:",e)}))},t.syncCookieFunc=i}}]);